name: Update GitHub Activity

on:
  schedule:
    - cron: 30 0 */2 * *
  workflow_dispatch:
  push:
    branches:
      - master
    paths:
      - .github/workflows/update-activity.yml

concurrency:
  # github.event.pull_request.number || github.ref: pull request number or branch name if not a pull request
  group: ${{ github.workflow }}-${{ github.event.pull_request.number || github.ref }}
  cancel-in-progress: true

env:
  CHECK_PERMISSIONS: 0

permissions: {}

jobs:
  update-activity:
    name: Update GitHub activity
    runs-on: ubuntu-latest
    permissions:
      actions: read
      contents: write
    steps:
      - id: check-permissions
        name: Check action permissions
        uses: GitHubSecurityLab/actions-permissions/monitor@b25f731bf2f9eb9748c2e9757d366c3e72fa2109 # v1.0.2-beta8
        if: env.CHECK_PERMISSIONS == '1'
      - id: checkout-repo
        name: Checkout repo
        uses: actions/checkout@34e114876b0b11c390a56381ad16ebd13914f8d5 # v4.3.1
        with:
          persist-credentials: false
      - id: update-activity
        name: Update GitHub Activity
        uses: TheDanniCraft/activity-log@b29a4176407e7dc762c9be0c9f7f27e0fc3d973c # v1
        with:
          GITHUB_USERNAME: ${{ github.actor }}
          GITHUB_TOKEN: ${{ secrets.ACTION_TOKEN }}
          EVENT_LIMIT: 15
          HIDE_DETAILS_ON_PRIVATE_REPOS: true
          IGNORE_EVENTS: "[DeleteEvent, WatchEvent]"
          EVENT_EMOJI_MAP: |
            PushEvent: "üöÄ"
            CreateEvent: "‚ú®"
            CommitCommentEvent: "üó£"
            IssueCommentEvent: "üó£"
            IssuesEvent: |
              opened: "‚ùó"
              closed: "‚úÖ"
              labeled: "üè∑Ô∏è"
            PullRequestEvent: |
              opened: "üîÄ"
              merged: "‚úîÔ∏è"
              labeled: "üè∑Ô∏è"
