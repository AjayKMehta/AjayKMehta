name: Update GitHub Activity

on:
  schedule:
    - cron: 30 0 */2 * *
  workflow_dispatch:
  push:
    branches:
      - master
    paths:
      - .github/workflows/update-activity.yml

env:
  CHECK_PERMISSIONS: 0

jobs:
  update-activity:
    runs-on: ubuntu-latest
    permissions:
      actions: read
      contents: write
    steps:
      - id: check-permissions
        name: Check permissions
        uses: GitHubSecurityLab/actions-permissions/monitor@b25f731bf2f9eb9748c2e9757d366c3e72fa2109 # v1
        if: env.CHECK_PERMISSIONS == '1'
      - id: checkout-repo
        name: Checkout repo
        uses: actions/checkout@34e114876b0b11c390a56381ad16ebd13914f8d5 # v4
        with:
          persist-credentials: false
      - id: update-activity
        name: Update GitHub Activity
        uses: TheDanniCraft/activity-log@b29a4176407e7dc762c9be0c9f7f27e0fc3d973c # v1
        with:
          GITHUB_USERNAME: ${{ github.actor }}
          GITHUB_TOKEN: ${{ secrets.ACTION_TOKEN }}
          EVENT_LIMIT: 15
          HIDE_DETAILS_ON_PRIVATE_REPOS: true
          IGNORE_EVENTS: "[DeleteEvent, WatchEvent]"
          EVENT_EMOJI_MAP: |
            PushEvent: "ğŸš€"
            CreateEvent: "âœ¨"
            CommitCommentEvent: "ğŸ—£"
            IssueCommentEvent: "ğŸ—£"
            IssuesEvent: |
              opened: "â—"
              closed: "âœ…"
              labeled: "ğŸ·ï¸"
            PullRequestEvent: |
              opened: "ğŸ”€"
              merged: "âœ”ï¸"
              labeled: "ğŸ·ï¸"
